<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>User Search</title>
  <link rel="stylesheet" type="text/css" th:href="@{/css/head_cus.css}"/>
  <link rel="stylesheet" type="text/css" th:href="@{/css/search.css}"/>
  <link rel="stylesheet" type="text/css" th:href="@{/webjars/bootstrap/css/bootstrap.min.css}"/>
  <style>
    /* Thay đổi chiều rộng của thanh tìm kiếm */
    #keyword {
      width: 50%;
    }

    /* Thêm viền cho phần tìm kiếm kết quả */
    .search-results {
      border: 3px solid #00285A;
      border-radius: 12px;
      padding: 15px;
      margin-top: 20px;
    }

    .post-card {
      margin-bottom: 18px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer; /* Thay đổi con trỏ khi di chuột qua */
    }

    .post-card:hover {
      background-color: #f0f0f0; /* Hiệu ứng hover */
    }

    .post-card button {
      background: #00285A;
      color: white;
      border: none;
      border-radius: 12px;
      padding: 5px 10px;
      cursor: pointer;
    }

    .post-card button:hover {
      background: #b289e1;
    }
  </style>
</head>

<body>

<!-- Sử dụng fragment header -->
<div th:replace="~{fragments/header :: header}"></div>

<div class="search-container" align="center">

  <!-- Search form -->
  <form th:action="@{/search}" method="get" class="mb-4">
    <input type="text" name="keyword" id="keyword" th:value="${keyword}" placeholder="Enter username or email" required class="form-control" style="border-radius: 12px; border: 2px solid #00285A;"/>
    <input type="submit" value="Search" class="btn btn-primary mt-2" style="border-radius: 12px; background: #00285A"/>
  </form>

  <br />

  <!-- Table for displaying search results -->
  <div class="search-results">
    <div th:each="user : ${listUser}" class="post-card" th:attr="data-username=${user.username}">
      <div>
        <p th:text="${user.username}">Post Content</p>
        <div class="post-meta">
          <span th:text="${user.email}">User Email</span>
        </div>
      </div>
      <form th:action="@{/add_friend}" method="post" style="display:inline;">
        <input type="hidden" name="username" th:value="${user.username}"/>
        <button type="submit" class="btn-icon">Add Friend</button>
      </form>
    </div>
  </div>
</div>

<!-- JavaScript -->
<script>
  // Xử lý sự kiện click cho các post-card
  document.addEventListener('DOMContentLoaded', function() {
    const postCards = document.querySelectorAll('.post-card');

    postCards.forEach(function(postCard) {
      postCard.addEventListener('click', function() {
        const username = postCard.getAttribute('data-username');
        console.log('Clicked on username:', username); // Log tên người dùng
        window.location.href = '/profile/' + username; // Chuyển hướng đến trang profile
      });
    });
  });
</script>

</body>
</html>
